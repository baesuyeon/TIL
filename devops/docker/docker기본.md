## Docker

![Alt text](image.png)

Docker는 애플리케이션을 실행하는 데 필요한 모든 것을 하나의 컨테이너로 패키징하여 어디서나 동일한 환경에서 실행할 수 있게 하는 기술이다.
전통적인 배포 방식에서는 dev 환경과 prod 환경의 차이로 인해 문제가 발생할 수 있었으나, Docker 를 사용하면 환경 차이로 인한 문제를 해결할 수 있다.

## Docker 이미지

Docker 이미지를 기반으로 컨테이너를 생성할 수 있다.
(Docker 이미지를 프로그램 설치 프로그램이라고 비유할 수 있다. Excel 설치 프로그램에는 Excel을 실행하기 위한 모든 파일과 설정이 포함되어있으며 이 설치 프로그램은 변경되지 않고 어디서든 동일하게 설치될 수 있다.)

- 이미지는 여러 layer 계층으로 구성된다.
- 각 계층은 캐시로 활용될 수  (동일한 계층이 이미 존재하면 다시 빌드하지 않고 캐시된 계층을 사용)

```bash
FROM ubuntu:20.04
RUN apt-get update && apt-get install -y python3
COPY . /app
```
- 첫 번째 계층, Ubuntu 20.04 이미지를 기반으로 한다.
- 두 번째 계층, Ubuntu 20.04 이미지 위에 패키지 설치 명령을 실행한다.
- 세 번째 계층, 현재 디렉토리의 파일을 이미지 내 /app 디렉토리에 복사한다.

## Docker 컨테이너

Docker 이미지를 실행한 상태이다.
컨테이너는 격리된 환경에서 애플리케이션을 실행하며 필요한 리소스와 네트워크 설정을 포함한다.

## Docker Hub

Docker Hub는 Docker 이미지를 저장, 공유, 배포할 수 있는 중앙 저장소이다.

## Dockerfile

## 🐳 Docker 명령어 정리

이 문서는 자주 사용하는 Docker 명령어들을 정리한 문서입니다.

### `docker run`

```bash
docker run -d -p 6379:6379 redis --name myredis
```

Redis 서버는 6379 포트를 열고 클라이언트의 요청을 받을 준비를 한다.

옵션 정리
| 옵션            | 설명                                       |
| -------------- | ---------------------------------------- |
| `-d`           | Detached 모드 (백그라운드 실행)                   |
| `-p 6379:6379` | 포트 맵핑, 호스트(로컬)의 포트 6379를 컨테이너의 6379 포트에 연결      |
| `redis`        | local 환경에서 Redis 이미지를 찾고 없으면 Docker Hub에서 자동 다운로드된다. |
| `name`         | 컨테이너 이름을 설정한다.   |

### docker ps

현재 실행 중인 Docker 컨테이너 목록을 확인할 수 있다.

옵션 정리
| 옵션            | 설명                                       |
| -------------- | ---------------------------------------- |
| `-a`           | 중지된 컨테이너 포함 전체 목록 표시               

### docker exec -it <컨테이너 이름 또는 ID> bash

컨테이너 내부에 접속 (bash 쉘)

```bash
docker exec -it myredis bash

redis-cli
```

redis-cli는 Redis 서버에 접속해서 명령을 보낼 수 있는 도구이다. (호스트 명과 포트번호를 생략하면 localhost의 6379로 접속된다.)

### docker logs <컨테이너 이름 또는 ID>

실행 중인 컨테이너의 표준 출력(stdout) 및 표준 에러(stderr) 로그를 확인할 수 있다.

옵션 정리
| 옵션           | 설명                   |
| ------------ | -------------------- |
| `-f`         | 실시간 로그 스트리밍 (follow) |
| `--tail <N>` | 마지막 N줄만 출력           |
| `-t`         | 로그에 타임스탬프 포함         |

### docker rm <컨테이너 이름 또는 ID>

해당 컨테이너 삭제
